HW4.1
1. дату и время, часовой пояс. Проверьте hostname, при необходимости поменять. Установить в качестве сервера времени `0.pool.ntp.org 1.pool.ntp.org`. Проверить правильность настройки, пояснить почему Вы решили что все правильно.  

1.1. Выполняем команду “sudo timedatectl set-timezone Europe/Minsk”, чтобы настроить минское время. Корректность выполнения команды в последствии была проверена командой “timedatectl”.  

1.2. Проверяем имя хоста командой “hostnamectl”.

<img width="940" height="336" alt="image" src="https://github.com/user-attachments/assets/cac8f679-4ffe-49aa-90b4-6f6e9739ec77" />
















1.3. Для установки сервера времени используем команду “sudo nano /etc/systemd/timesyncd.conf”. Далее в редакторе добавляем нужные строки.







После этого выполняем команду “sudo systemctl restart systemd-timesyncd”.Далее выполняем проверку корректности командой “timedatectl timesync-status”.













 2. Статический ip-address, маршрут по умолчанию и днс сервер при помощи `netplan`.

2.1. Для настройки статического ip-адреса мы для начала перешли в нужный каталог командой cd /etc/netplan/, далее зашли в редактор командой “sudo nano 50-cloud-init.yaml” и испраивили то, что нам нужно было (addresses; via). После внесения изменений выполнили команду “sudo netplan try”, чтобы проверить корректность и применить изменения.













После этого проверили, выполнилась ли настройка.


3. 2 пользователей в разных группах. Выдайте группе права на обновление системы через настройку `sudo visudo`. Для одного из пользователей настройте права для использования `systemctl status`. Настройте доступ по ssh для новых пользователей через ssh ключи. Доступ по ssh по логину и паролю запретите.


3.1. Создаём группы “group1” и “group2”, а также создаём 2 пользователей для этих групп: user1g1(group1) и user1g2(group2). И проверяем правильно ли были выполнены действия. 





3.2. Далее даём группе group1 право обнавлять систему через sudoers. Используем команду “sudo visudo” и добавляем строку “%group1 ALL=(ALL) /usr/bin/apt update, /usr/bin/apt upgrade”, которая позволит group1 обновлять систему.

Далее поверяем корректность синтаксиса командой sudo visudo -c.







Далее проверяем права доступа. Заходим под пользователем user1g1 и проверяем возможно ли выполнить обновление.




3.3. Разрешаем пользователю user1g2 право на systemctl status.  Добавляем правила в /etc/sudoers.d/ с помощью команды sudo nano /etc/sudoers.d/user1g2. 


Права на файл:

Выполняем проверку: 


3.4. Создаём папку shh для user1g1 c помощью команды sudo mkdir -p /home/user1g1/.ssh, потом создаём файл authorized_keys c помощью команды sudo touch /home/user1g1/.ssh/authorized_keys, а потом даём доступ user1g1 к этой папке sudo chown -R user1g1:user1g1 /home/user1g1/.ssh. А также выдаём права командами sudo chmod 700 /home/user1g2/.ssh; sudo chmod 600 /home/user1g2/.ssh/authorized_keys.
Далее мы вставили публичный ключ в папку authorized_keys.

Далее проверили подключение с нашего хоста.









Потом делаем то же самое для user1g2. 














3.5 Запрещаем пользователям user1g1, user1g2 вход через ssh по  паролю.

 4. Каталог для работы группы людей, настройте что бы права во внутренних каталогах наследовались от  группы директории, а не основную группу пользователя. В ней создайте файл под одним из пользоватей разрешите доступ к нему только для владельца.	
 
Создаём каталог с вложенной в неё папку командой sudo mkdir -p /srv/shared в корневой директории, потом указываем владельца и группу для этих директорий sudo chown user1g1:group1 /srv/shared. Далее присваиваем права доступа sudo chmod 2775 /srv/shared, потом проверяем.

Далее задаём права доступа для группы для  всех вложенных каталогов и файлов командой sudo setfacl -d -m g::rwx /srv/shared, а также для остальных пользователей sudo setfacl -d -m o::- /srv/shared. 

 Создаём папку touch test_file.txt и файл mkdir test_dir и проверяем какие права доступа есть у пользователя.

Создаём папку touch private.txt и устанавливаем права доступа только владельцу chmod 600 private.txt. 

5. сетевой доступ к виртуальной машине только по 22 и 80. Попробуйте подключиться по ssh. Установить nginx `sudo apt install nginx` посмотрите что доступно из браузера вашей основной машины при разрешенном трафике и запрещенном. Найдите информацию почему мы разрешали именно 80 порт, какие еще зарезервированные порты вы знаете?

Настраиваем сетевой доступ по 22 порту(SSH) sudo ufw allow 22/tcp comment 'SSH' и по 80(TCP) sudo ufw allow 80/tcp comment 'HTTP'. А также запрещаем входящую информацию sudo ufw default allow outgoing и разрешаем исходящую sudo ufw default deny incoming.


Далее применяем и включаем firewall.

Проверяем сетевой трафик sudo ufw status verbose
Загружаем nginx командой sudo apt install nginx.

Проверяем загружен и запущен ли ngnix командой sudo systemctl status nginx.


Проверяем работоспособность nginx

 В браузере мы видим следующее:







Найдите информацию почему мы разрешали именно 80 порт, какие еще зарезервированные порты вы знаете?
Потому что nginx работает по http, а http идёт по 80 порту.
Часто используемые порты:
Номер порта	Протокол	Название сервиса
20	TCP	FTP - данные
21	TCP	FTP - контрольное соединение
22	TCP	SSH-сервер
23	TCP	Telnet-сервер
25	TCP	SMTP - отправка почты
53	TCP, UDP	DNS - сервер доменных имен
69	UDP	TFTP-сервер
80	TCP	HTTP - web-сервер
110	TCP	POP3 - прием почты
145	TCP	IMAP - прием почты
161	UDP	SNMP - протокол управления сетевыми устройствами
443	TCP	HTTPS - защищенный шифрованием протокол HTTP
587	TCP	Защищенный шифрованием протокол SMTP
993	TCP	Защищенный шифрованием протокол IMAP
995	TCP	Защищенный шифрованием протокол POP3
1500	TCP	Панель ISPManager
2083	TCP	Панель cPanel
3306	TCP	Сервер базы данных MySQL
8083	TCP	Панель Vesta
 
